services:
  # Auth Service
  - type: web
    name: auth-service
    plan: free
    env: node
    buildCommand: npm install
    startCommand: node server.js
    rootDir: auth-service
    envVars:
      - key: PORT
        value: 5001

  # Grocery Service
  - type: web
    name: grocery-service
    plan: free
    env: node
    buildCommand: npm install
    startCommand: node server.js
    rootDir: grocery-service
    envVars:
      - key: PORT
        value: 5002
      - key: MONGO_URI
        sync: false # User will provide the Atlas connection string manually in Render dashboard

  # Cart Service
  - type: web
    name: cart-service
    plan: free
    env: node
    buildCommand: npm install
    startCommand: node server.js
    rootDir: cart-service
    envVars:
      - key: PORT
        value: 5003

  # Order Service
  - type: web
    name: order-service
    plan: free
    env: node
    buildCommand: npm install
    startCommand: node server.js
    rootDir: order-service
    envVars:
      - key: PORT
        value: 5004

  # Frontend Service (Gateway)
  - type: web
    name: frontend-service
    plan: free
    env: node
    buildCommand: npm install
    startCommand: node server.js
    rootDir: frontend-service
    envVars:
      - key: PORT
        value: 5000
      - key: AUTH_SERVICE
        fromService:
          name: auth-service
          type: web
          property: host
      - key: GROCERY_SERVICE
        fromService:
          name: grocery-service
          type: web
          property: host
      - key: CART_SERVICE
        fromService:
          name: cart-service
          type: web
          property: host
      - key: ORDER_SERVICE
        fromService:
          name: order-service
          type: web
          property: host
